(()=>{"use strict";let t,e,n="",o=null;function s(t){const e=function(){if(o)return o;o=document.createElement("div"),o.id="easy-egov-jump-hud",Object.assign(o.style,{position:"fixed",bottom:"60px",left:"50%",transform:"translateX(-50%) translateY(30px)",backgroundColor:"rgba(255, 255, 255, 0.7)",backdropFilter:"blur(20px) saturate(180%)",WebkitBackdropFilter:"blur(20px) saturate(180%)",padding:"16px 32px",borderRadius:"24px",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.05)",border:"1px solid rgba(255, 255, 255, 0.5)",color:"#1a1a1a",fontSize:"24px",fontWeight:"700",fontFamily:'"Outfit", "Inter", "Roboto", sans-serif',zIndex:"10000",display:"flex",alignItems:"baseline",gap:"16px",opacity:"0",transition:"all 0.4s cubic-bezier(0.23, 1, 0.32, 1)",pointerEvents:"none",letterSpacing:"-0.02em",scale:"0.9"}),o.innerHTML='\n    <span style="opacity: 0.4; font-size: 12px; font-weight: 800; text-transform: uppercase; letter-spacing: 0.1em;">Jump to</span>\n    <div id="easy-egov-jump-text-container" style="display: flex; align-items: baseline; gap: 4px;">\n      <span id="easy-egov-jump-text"></span>\n      <span id="easy-egov-jump-cursor" style="width: 2px; height: 24px; background: #007AFF; display: inline-block; animation: blink 1s infinite; margin-left: 4px;"></span>\n    </div>\n  ';const t=document.createElement("style");return t.textContent="\n    @keyframes blink {\n      0%, 100% { opacity: 1; }\n      50% { opacity: 0; }\n    }\n    #easy-egov-jump-text {\n      background: linear-gradient(135deg, #1a1a1a 0%, #4a4a4a 100%);\n      -webkit-background-clip: text;\n      -webkit-text-fill-color: transparent;\n    }\n  ",document.head.appendChild(t),document.body.appendChild(o),o}(),n=document.getElementById("easy-egov-jump-text");if(t.length>0){const o=t.trim().split(/\s+/),s=o[0]||"",i=o.slice(1).join("の"),a=`第${s}条${i?"の"+i:""}`;n&&(n.textContent=a),e.style.opacity="1",e.style.transform="translateX(-50%) translateY(0)",e.style.scale="1"}else e.style.opacity="0",e.style.transform="translateX(-50%) translateY(30px)",e.style.scale="0.9"}function i(){t&&window.clearTimeout(t),t=window.setTimeout(()=>{n="",s("")},1e3)}function a(t){if(0===t)return"〇";const e=["","十","百","千"],n=["","一","二","三","四","五","六","七","八","九"];let o="";const s=t.toString();for(let t=0;t<s.length;t++){const i=s[s.length-1-t];if(!i)continue;const a=parseInt(i),r=t%4;0!==a&&(o=(1===a&&r>0?"":n[a]||"")+(e[r]||"")+o),3===t&&s.length>4&&(o="万"+o)}return o}function r(t){return t.replace(/[0-9]/g,t=>String.fromCharCode(t.charCodeAt(0)+65248))}function l(t,e){const n=t.textContent||"",o=e.split("").map(t=>t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).join("\\s*"),s=new RegExp(o,"i"),i=n.match(s);if(!i||void 0===i.index)return void c(t);const a=i.index,r=a+i[0].length,l=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null);let u=0;const d=document.createRange();let p,f=null,g=0,m=null,x=0;for(;p=l.nextNode();){const t=p,e=t.textContent?.length||0;if(!f&&u+e>a&&(f=t,g=a-u),f&&u+e>=r){m=t,x=r-u;break}u+=e}if(f&&m){d.setStart(f,g),d.setEnd(m,x);const e=document.createElement("span");Object.assign(e.style,{backgroundColor:"rgba(255, 230, 0, 0.45)",boxShadow:"0 0 12px rgba(255, 215, 0, 0.3)",borderRadius:"4px",padding:"2px 0",transition:"all 0.6s cubic-bezier(0.4, 0, 0.2, 1)",cursor:"default"});try{d.surroundContents(e),setTimeout(()=>{e.style.backgroundColor="transparent",e.style.boxShadow="none",setTimeout(()=>{if(e.parentNode){const t=e.parentNode;for(;e.firstChild;)t.insertBefore(e.firstChild,e);t.removeChild(e),t.normalize()}},600)},2e3)}catch(e){c(t)}}else c(t)}function c(t){const e=t.style.backgroundColor,n=t.style.transition;t.style.transition="all 0.6s cubic-bezier(0.4, 0, 0.2, 1)",t.style.backgroundColor="rgba(255, 230, 0, 0.35)",setTimeout(()=>{t.style.backgroundColor=e,setTimeout(()=>{t.style.transition=n},600)},2e3)}function u(){e&&clearTimeout(e),n.endsWith(" ")||(e=window.setTimeout(()=>{n.length>0&&function(t){const n=t.trim().split(/\s+/);if(0===n.length||""===n[0])return;const o=n[0];if(!o)return;const s=parseInt(o);if(isNaN(s))return;const i=n[0],c=r(i),u=a(s),d=n.slice(1),p=[`第${i}条${d.length>0?"の"+d.join("の"):""}`,`第${c}条${d.length>0?"の"+d.map(t=>r(t)).join("の"):""}`,`第${u}条${d.length>0?"の"+d.map(t=>a(parseInt(t))).join("の"):""}`],f=[];for(const t of p){const e=`//*[(contains(@class, "ArticleTitle") or contains(@class, "ParagraphNum")) and contains(., "${t}")]`,n=document.evaluate(e,document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(let e=0;e<n.snapshotLength;e++){const o=n.snapshotItem(e);if(o.closest("a"))continue;const s=(o.textContent||"").replace(/[\s,]/g,""),i=s.indexOf(t);if(-1===i)continue;const a=s[i+t.length];if(a&&/[0-9０-９の]/.test(a))continue;let r=0;const l=o.getAttribute("class")||"";l.includes("ArticleTitle")&&(r+=1e3),l.includes("ParagraphNum")&&(r+=500),0===i&&(r+=2e3),f.push({node:o,score:r,text:t})}if(f.length>0)break;const o=`//*[not(self::script) and not(self::style) and contains(., "${t}")]`,s=document.evaluate(o,document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(let e=0;e<s.snapshotLength;e++){const n=s.snapshotItem(e);if(n.closest("a"))continue;const o=(n.textContent||"").replace(/[\s,]/g,""),i=o.indexOf(t);if(-1===i)continue;const a=o[i+t.length];if(a&&/[0-9０-９の]/.test(a))continue;let r=n;const l=n.querySelectorAll("*");for(const e of Array.from(l)){const n=(e.textContent||"").replace(/[\s,]/g,""),o=n.indexOf(t);if(-1!==o){const s=n[o+t.length];s&&/[0-9０-９の]/.test(s)||(r=e)}}f.push({node:r,score:0===i?100:0,text:t})}if(f.length>0)break}if(f.length>0){const t=f.filter(t=>t.node.closest('aside, nav, [class*="side"], [class*="tree"], [id*="side"], [id*="tree"]')),n=f.filter(e=>!t.includes(e));t.sort((t,e)=>e.score-t.score),n.sort((t,e)=>e.score-t.score);const o=t[0],s=n[0];o&&(o.node.click(),o.node.scrollIntoView({behavior:"auto",block:"center"})),s?(s.node.scrollIntoView({behavior:"auto",block:"center"}),l(s.node,s.text)):o&&!s&&l(o.node,o.text),e&&clearTimeout(e)}else console.log(`Article targets ${JSON.stringify(p)} not found. (Input: "${t}")`)}(n)},500))}document.addEventListener("keydown",t=>{const o=t.target;if(!["INPUT","TEXTAREA","SELECT","CONTENTEDITABLE"].includes(o.tagName)&&!o.isContentEditable)if(/^[0-9 ]$/.test(t.key)){if(" "===t.key&&0===n.length)return;" "===t.key&&t.preventDefault(),n+=t.key,s(n),i(),u()}else"Backspace"===t.key?n.length>0&&(n=n.slice(0,-1),s(n),i(),u()):"Escape"===t.key&&(n="",s(""),e&&clearTimeout(e))})})();
//# sourceMappingURL=jump.js.map